---
name: code-review
description: Git の差分に対してコードレビューを実行する
---

# コードレビュー

以下の手順でコードレビューを行ってください:

1. `run_command` で `git diff` を実行して変更内容を取得
2. 変更がない場合は `git diff HEAD~1` で直前のコミットの差分を確認
3. 以下の観点でレビュー:

## レビュー観点

### バグ・ロジックエラー
- off-by-one エラー
- null/undefined チェック漏れ
- 例外処理の不足
- 競合状態・スレッドセーフティ

### セキュリティ
- インジェクション（SQL, XSS, コマンド）
- 認証・認可の不備
- 機密情報のハードコード
- 入力バリデーション

### パフォーマンス
- N+1 クエリ
- 不要なループ・再計算
- メモリリーク
- 大量データの非効率な処理

### コード品質
- 命名の分かりやすさ
- 関数/メソッドの責務の単一性
- DRY 原則の遵守
- エラーメッセージの適切さ

## 出力フォーマット

問題点は以下の形式で報告:

```
### [重要度: 高/中/低] 問題の概要
- ファイル: <path>
- 行: <line>
- 問題: <説明>
- 提案: <修正案>
```

最後に全体の総評を述べてください。
